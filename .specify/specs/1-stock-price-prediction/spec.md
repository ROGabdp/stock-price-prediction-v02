# 功能規格書：股價漲跌機率預測系統

**功能分支**: `1-stock-price-prediction`  
**建立日期**: 2025-11-12
**狀態**: 草稿  
**輸入**: 使用者描述: "我要製作一個股價漲跌機率預測系統。運用機械學習的方式，從歷史資料訓練出模型，並且用模型預測未來N天的股價漲跌機率和漲跌幅。每次訓練出來的模型都用不同的檔名儲存，便於我選擇訓練較為成功的模型，訓練完的模型要能夠在使用者介面內直接選擇。並且我後續也會持續更新資料，所以要有介面能夠讓我輕鬆的選擇訓練用的資料。除此之外，介面也要能夠把歷史資料和預測的漲跌狀況，用圖表的方式畫出來。"

## 使用者場景與測試 *(必要)*

### 使用者故事 1 - 模型訓練與預測 (優先級: P1)

作為使用者，我想要上傳或選擇一個歷史股價資料集，並啟動模型訓練，系統應自動調整參數並進行多次訓練，以生成對未來 N 天股價的預測結果。

**優先級原因**: 這是系統的核心功能，實現了從資料到預測的基本流程。

**獨立測試**: 使用者可以成功上傳一個 CSV 檔案，點擊「訓練」按鈕，系統會產生一個模型檔案，並在介面上顯示未來 N 天的漲跌機率與幅度預測表格。

**驗收場景**:

1. **假設** 使用者已選擇一個有效的股價資料檔案，**當** 使用者點擊「開始訓練」，**那麼** 系統應開始處理資料並訓練模型，並在完成後通知使用者。
2. **假設** 模型已訓練完成，**當** 使用者查看結果，**那麼** 介面應顯示未來 N 天的預測數據。

---

### 使用者故事 2 - 視覺化圖表 (優先級: P2)

作為使用者，我想要在一個圖表上同時看到歷史股價和我所選模型的預測結果，以便直觀地評估預測的趨勢。

**優先級原因**: 視覺化是理解與評估模型預測結果最直接的方式。

**獨立測試**: 當模型訓練完成或被選中後，介面會顯示一個包含兩條線的圖表：一條代表歷史收盤價，另一條代表模型預測的未來價格趨勢。

**驗收場景**:

1. **假設** 一個模型已經被訓練或選取，**當** 使用者查看圖表，**那麼** 圖表應正確繪製歷史數據和預測數據。
2. **假設** 使用者將滑鼠懸停在圖表的預測部分，**當** 滑鼠停在某個預測點上，**那麼** 應顯示該點的具體日期、預測漲跌幅與機率。

---

### 使用者故事 3 - 模型與資料選擇 (優先級: P3)

作為使用者，我想要能夠從一個列表中輕鬆選擇不同的訓練資料集和之前已訓練好的模型，以便進行比較和重新預測。

**優先級原因**: 提升系統的易用性和可擴展性，讓使用者可以管理多個模型與資料集。

**獨立測試**: 介面上有兩個下拉式選單。一個用於選擇不同的資料檔案，另一個用於選擇已儲存的模型檔案。選擇後，系統會使用所選項目更新預測結果和圖表。

**驗收場景**:

1. **假設** 系統中已存在多個模型檔案，**當** 使用者從模型下拉選單中選擇一個新模型，**那麼** 預測結果和圖表應在 3 秒內更新以反映新模型的預測。
2. **假設** 使用者從資料下拉選單中選擇一個新的資料集，**當** 使用者點擊「開始訓練」，**那麼** 系統會使用新的資料集來訓練一個全新的模型。

---

### 邊界案例

- 當上傳的資料格式不正確或欄位缺失時，系統應如何提示使用者？
- 當訓練過程中發生錯誤時，系統應如何處理並告知使用者？
- 如果沒有任何已訓練的模型，模型選擇介面應如何顯示？

## 需求 *(必要)*

### 功能需求

- **FR-001**: 系統必須允許使用者上傳或選擇歷史股價資料檔案（例如 CSV 格式）。
- **FR-002**: 系統必須使用選擇的資料來訓練一個機器學習預測模型。
- **FR-003**: 系統必須將每個訓練好的模型以唯一的檔案名稱儲存。
- **FR-004**: 系統必須提供介面讓使用者能從已儲存的模型列表中選擇一個模型。
- **FR-005**: 系統必須使用選定的模型來預測未來 N 天的股價漲跌機率和幅度。
- **FR-006**: 系統必須在一個折線圖上展示歷史數據和預測數據。
- **FR-007**: 預測天數（N）必須是使用者可配置的。範圍：1 到 30 天，預設值：5 天。
- **FR-008**: 系統必須在模型訓練過程中，根據預設或使用者定義的標準（例如：損失函數、測試結果），自動調整參數並進行多次訓練，以尋找最佳模型。

### 關鍵實體 *(若功能涉及資料則包含此項)*

- **歷史資料**: 代表一組股價數據點，至少包含日期和收盤價。
- **預測模型**: 一個已訓練完成並儲存的機器學習模型檔案。
- **預測結果**: 給定模型的輸出，包含未來 N 天的漲跌機率和幅度。

## 成功標準 *(必要)*

### 可衡量的成果

- **SC-001**: 使用者從上傳資料到看見預測圖表的完整流程，應在 5 分鐘內完成（不含長時間的模型訓練）。
- **SC-002**: 介面上的圖表必須清楚地區分歷史數據和預測數據。
- **SC-003**: 使用者切換不同已訓練模型時，對應的預測結果應在 3 秒內更新。
- **SC-004**: 系統應在合理的時間內（例如：30分鐘內）完成自動參數調整與模型訓練，並產出至少一個達到預設效能標準的模型。
